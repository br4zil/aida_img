{% extends 'galeria/base.html' %}

{% load static %}
{% block content %}



{% comment %} <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <!-- Campo para selecionar vÃ¡rias imagens -->
    <br>
    
    
</form> {% endcomment %}



<div class="card">
    <div class="card-header">
        <h5>Imagens do Curso: {{ request.session.nome_curso }}  </h5>
    </div>
    <div class="card-body form-group">
        <p>&nbsp;</p>
        <form method="post" enctype="multipart/form-data" id="form">
            {% csrf_token %}
            <div class="row">
                <label for="id_imagem">Imagens:</label>
                <input type="file" id="id_imagem" name="imagem" multiple required class="form-control">
            </div>
            <div class="row form-group my-3">
                <div class="col-12 col-lg-12 text-center">
                    <input type="submit" value="Enviar" class="btn btn-success">
                    <a class="btn btn-secondary" href="/galeria-list/{{ request.session.id_curso }}">Cancelar</a>
                </div>
                {% comment %} <div class="progress">
                    <div class="progress-bar" id="progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                  </div> {% endcomment %}
            </div>
        </form>
    </div>
  </div>


{% comment %} 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    console.log('teste');


    document.getElementById('form').addEventListener('submit', function(event) {
        event.preventDefault();
        var files = document.getElementById('id_imagem').files;
    
        var totalFileSize = 0;
        for (var i = 0; i < files.length; i++) {
            totalFileSize += files[i].size; // Calcula o tamanho total dos arquivos
        }
        console.log('Total de bytes dos arquivos selecionados para envio:', totalFileSize);
    
        var formData = new FormData();
        for (var i = 0; i < files.length; i++) {
            formData.append('imagem[]', files[i]);
        }
    
        var xhr = new XMLHttpRequest();
        xhr.open('POST', event.target.action, true);
    
        xhr.upload.onprogress = function(e) {
            if (e.lengthComputable) {
                console.log('Total de bytes enviados:', e.loaded);
            }
        };
    
        xhr.onload = function() {
            if (xhr.status === 200) {
                console.log('Todos os arquivos foram enviados com sucesso.');
            } else {
                console.error('Erro ao enviar arquivos:', xhr.statusText);
            }
        };
    
        xhr.onerror = function() {
            console.error('Erro de rede ao enviar arquivos.');
        };
    
        xhr.send(formData);
    });
    
    
    
    
    


        
    </script>
     {% endcomment %}

    

    



    

{% endblock %}
